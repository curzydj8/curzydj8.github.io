document.addEventListener('DOMContentLoaded',function(){const form=document.getElementById('loginForm'),email=document.getElementById('email'),password=document.getElementById('password'),emailError=document.getElementById('emailError'),passwordError=document.getElementById('passwordError'),notice=document.getElementById('notice'),toggle=document.querySelector('.toggle-pw');const isLoggedIn=localStorage.getItem('isLoggedIn');if(isLoggedIn==='true'){const currentPage=window.location.pathname;if(currentPage.includes('dos-commands')||currentPage.includes('linux-commands')||currentPage.includes('powershell-commands'))return;}toggle.addEventListener('click',()=>{const type=password.type==='password'?'text':'password';password.type=type;toggle.textContent=type==='password'?'显示':'隐藏';toggle.setAttribute('aria-label',type==='password'?'显示密码':'隐藏密码');});function clearErrors(){emailError.textContent='';passwordError.textContent='';notice.textContent='';}form.addEventListener('submit',function(e){e.preventDefault();clearErrors();let ok=true;const vEmail=email.value.trim(),vPassword=password.value; if(!vEmail){emailError.textContent='请输入邮箱或用户名';ok=false;}if(!vPassword||vPassword.length<6){passwordError.textContent='密码至少6位';ok=false;}if(!ok)return;notice.textContent='正在登录…';const btn=form.querySelector('button[type="submit"]');btn.disabled=true;const validEmail='admin',validPassword='123456';setTimeout(()=>{btn.disabled=false;if(vEmail===validEmail&&vPassword===validPassword){localStorage.setItem('isLoggedIn','true');localStorage.setItem('userName',vEmail);notice.textContent='登录成功，正在跳转...';notice.style.color='#22c55e';setTimeout(()=>{window.location.href='index.html';},500);}else{notice.textContent='用户名或密码错误';notice.style.color='#ef4444';}},900);});});function checkLoginForCommands(){const currentPage=window.location.pathname,isCommandPage=currentPage.includes('dos-commands')||currentPage.includes('linux-commands')||currentPage.includes('powershell-commands');if(isCommandPage){const isLoggedIn=localStorage.getItem('isLoggedIn');if(isLoggedIn!=='true'){alert('请先登录！');window.location.href='index.html';}}}document.addEventListener('DOMContentLoaded',checkLoginForCommands);function logout(){localStorage.setItem('isLoggedIn','false');localStorage.removeItem('userName');window.location.href='index.html';}
